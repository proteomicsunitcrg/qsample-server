version: "3.2"
services:
  db:
    image: mariadb:10.7
    command: --default-authentication-plugin=mysql_native_password
    restart: always
    volumes:
      # Where starting dumps are stored
      - ./sql:/docker-entrypoint-initdb.d
      # Where data will be stored
      - ./mysql:/var/lib/mysql
    expose:
      - 3306
    environment:
      MARIADB_ROOT_PASSWORD: qsample2022
      MARIADB_USER: qsample
      MARIADB_PASSWORD: qsample2017
      MARIADB_DATABASE: qsample
  app:
    # image: qsample:latest
    build: .
    restart: always
    volumes:
      - type: bind
        source: ./src/main/resources/application.yml
        target: /config/application.yml
        read_only: true
    ports:
      # Ports exposed outside, they should match config
      - 8081
      - 8082
